SELECT REG.REG_NM,
       AREA.AREA_NM,
       BRNCH.BRNCH_NM,
       CLNT.CLNT_ID,
       CLNT.FRST_NM || ' ' || CLNT.LAST_NM
           AS CLNT_NM,
       MWI.MOB_WAL_NO,
       MWI.CRTD_DT,
       DVH.DSBMT_DT,
       (  SELECT TYP.TYP_STR
            FROM MW_TYPS TYP
           WHERE TYP.TYP_ID = MWI.MOB_WAL_CHNL
        GROUP BY TYP.TYP_STR)
           AS MOB_WAL_CHNL_TYP,
       PYMT_TYP.TYP_STR
           AS DSBMT_MODE,
       DVD.AMT,
       LA.LOAN_APP_STS
  FROM MW_LOAN_APP  LA
       JOIN MW_PORT PORT
           ON PORT.PORT_SEQ = LA.PORT_SEQ AND PORT.CRNT_REC_FLG = 1
       JOIN MW_BRNCH BRNCH
           ON BRNCH.BRNCH_SEQ = PORT.BRNCH_SEQ AND BRNCH.CRNT_REC_FLG = 1
       JOIN MW_AREA AREA
           ON AREA.AREA_SEQ = BRNCH.AREA_SEQ AND AREA.CRNT_REC_FLG = 1
       JOIN MW_REG REG ON REG.REG_SEQ = AREA.REG_SEQ AND REG.CRNT_REC_FLG = 1
       JOIN MW_CLNT CLNT
           ON CLNT.CLNT_SEQ = LA.CLNT_SEQ AND CLNT.CRNT_REC_FLG = 1
       JOIN MW_DSBMT_VCHR_HDR DVH
           ON DVH.LOAN_APP_SEQ = LA.LOAN_APP_SEQ AND DVH.CRNT_REC_FLG = 1
       JOIN MW_DSBMT_VCHR_DTL DVD
           ON DVD.DSBMT_HDR_SEQ = DVH.DSBMT_HDR_SEQ AND DVD.CRNT_REC_FLG = 1
       JOIN MW_TYPS PYMT_TYP
           ON     PYMT_TYP.TYP_SEQ = DVD.PYMT_TYPS_SEQ
              AND PYMT_TYP.CRNT_REC_FLG = 1
       JOIN MW_MOB_WAL_INFO MWI
           ON MWI.MOB_WAL_SEQ = DVH.MOB_WAL_SEQ AND MWI.CRNT_REC_FLG = 1
       JOIN mw_prd mpd ON MPD.PRD_SEQ = LA.PRD_SEQ AND MPD.CRNT_REC_FLG = 1
       JOIN mw_prd_grp mpg ON mpg.PRD_GRP_SEQ = mpd.PRD_GRP_SEQ AND mpg.CRNT_REC_FLG = 1
 WHERE     LA.CRNT_REC_FLG = 1 and mpg.PRD_GRP_SEQ != 6
       AND TRUNC (DVH.DSBMT_DT) BETWEEN TO_DATE ( :from_dt, 'DD-MM-YYYY')
                                    AND TO_DATE ( :to_dt, 'DD-MM-YYYY')
union
SELECT REG.REG_NM,
       AREA.AREA_NM,
       BRNCH.BRNCH_NM,
       CLNT.CLNT_ID,
       CLNT.FRST_NM || ' ' || CLNT.LAST_NM
           AS CLNT_NM,
       MWI.MOB_WAL_NO,
       MWI.CRTD_DT,
       TRUNC (EP.EFF_START_DT) DSBMT_DT,
       (  SELECT TYP.TYP_STR
            FROM MW_TYPS TYP
           WHERE TYP.TYP_ID = MWI.MOB_WAL_CHNL
        GROUP BY TYP.TYP_STR)
           AS MOB_WAL_CHNL_TYP,
       PYMT_TYP.TYP_STR
           AS DSBMT_MODE,
       EP.EXPNS_AMT AMT,
       LA.LOAN_APP_STS
  FROM MW_LOAN_APP  LA
       JOIN MW_PORT PORT
           ON PORT.PORT_SEQ = LA.PORT_SEQ AND PORT.CRNT_REC_FLG = 1
       JOIN MW_BRNCH BRNCH
           ON BRNCH.BRNCH_SEQ = PORT.BRNCH_SEQ AND BRNCH.CRNT_REC_FLG = 1
       JOIN MW_AREA AREA
           ON AREA.AREA_SEQ = BRNCH.AREA_SEQ AND AREA.CRNT_REC_FLG = 1
       JOIN MW_REG REG ON REG.REG_SEQ = AREA.REG_SEQ AND REG.CRNT_REC_FLG = 1
       JOIN MW_CLNT CLNT
           ON CLNT.CLNT_SEQ = LA.CLNT_SEQ AND CLNT.CRNT_REC_FLG = 1
       JOIN MW_EXP EP ON TO_NUMBER(EP.EXP_REF) = LA.LOAN_APP_SEQ
        AND EP.CRNT_REC_FLG = 1
       JOIN MW_DSBMT_VCHR_HDR DVH
           ON DVH.LOAN_APP_SEQ = LA.LOAN_APP_SEQ AND DVH.CRNT_REC_FLG = 1
       JOIN MW_TYPS PYMT_TYP
           ON     PYMT_TYP.TYP_SEQ = EP.PYMT_TYP_SEQ
              AND PYMT_TYP.CRNT_REC_FLG = 1
       JOIN MW_MOB_WAL_INFO MWI
           ON MWI.MOB_WAL_SEQ = DVH.MOB_WAL_SEQ AND MWI.CRNT_REC_FLG = 1
       JOIN mw_prd mpd ON MPD.PRD_SEQ = LA.PRD_SEQ AND MPD.CRNT_REC_FLG = 1
       JOIN mw_prd_grp mpg ON mpg.PRD_GRP_SEQ = mpd.PRD_GRP_SEQ AND mpg.CRNT_REC_FLG = 1
 WHERE     LA.CRNT_REC_FLG = 1
       AND mpg.PRD_GRP_SEQ = 6
       AND TRUNC (EP.EFF_START_DT) BETWEEN TO_DATE ( :from_dt, 'DD-MM-YYYY')
                                    AND TO_DATE ( :to_dt, 'DD-MM-YYYY')